# bridge.yaml — ros2_mcp_bridge configuration
#
# All settings are under the ros2_mcp_bridge key so this file can also be
# loaded as a ROS 2 parameter file (ros2 param load ...).
#
# Override the config file path at runtime with:
#   export ROS2_MCP_BRIDGE_CONFIG=/path/to/bridge.yaml

ros2_mcp_bridge:

  # ── MCP server ────────────────────────────────────────────────────────── #
  transport: streamable-http   # FastMCP transport type (do not change)
  host: 0.0.0.0                # Bind address; 0.0.0.0 = all interfaces
  port: 18210                  # HTTP port the MCP server listens on
  path: /ros2                  # URL path; onit connects to http://<ip>:18210/ros2

  # ── Robot limits ─────────────────────────────────────────────────────── #
  robot:
    max_linear_speed: 0.22     # m/s  — TurtleBot3 Burger maximum
    max_angular_speed: 2.84    # rad/s
    # Wheel-radius calibration scale factor.  If move_distance consistently
    # over/under-shoots, run calibrate_motion, measure with a tape measure,
    # and set: scale = odometry_reported / actual_measured.
    # 1.0 = trust odometry as-is.  > 1.0 = odom over-reports distance.
    wheel_radius_scale: 1.0

  # cmd_vel topic for motion commands
  cmd_vel_topic: /cmd_vel

  # Approximate image width used for steering heuristic in approach_object
  image_width: 640

  # ── Collision avoidance ───────────────────────────────────────────────── #
  # LiDAR-based collision avoidance applied to all linear motion commands.
  # Each movement tool also exposes a per-call `collision_avoidance` parameter
  # that can override this global switch.
  collision_avoidance:
    enabled: true             # Master switch; set to false to disable globally
    min_front_distance: 0.30  # m — suppress forward motion if obstacle closer
    min_rear_distance:  0.20  # m — suppress backward motion if obstacle closer

  # ── Topic subscriptions ───────────────────────────────────────────────── #
  # Each entry: {topic: <ros2 topic>, type: <pkg/MsgType>}
  # Add or remove entries to match your robot's topic layout.
  topics:

    camera:
      topic: /camera/image_raw/compressed
      type: sensor_msgs/CompressedImage

    laser:
      topic: /scan
      type: sensor_msgs/LaserScan

    odom:
      topic: /odom
      type: nav_msgs/Odometry

    detections:
      topic: /detections
      type: vision_msgs/Detection2DArray

    # Battery state (sensor_msgs/BatteryState) — available on both stock
    # TurtleBot3 and Pico variants.  Tools degrade gracefully if absent.
    battery:
      topic: /battery_state
      type: sensor_msgs/BatteryState

    # TurtleBot3-specific sensor state (encoder counts, torque, bumper).
    # Requires turtlebot3_msgs to be installed.  The MCP tool returns an
    # error if the topic never publishes — safe to leave enabled.
    sensor_state:
      topic: /sensor_state
      type: turtlebot3_msgs/SensorState

    # IMU data (orientation, angular velocity, linear acceleration).
    # On the Pico variant this is the BNO055 / BNO085 9-DOF NDOF fusion sensor
    # (Grove 6 / Grove 1).  On stock TurtleBot3 this is the MPU-9250 on OpenCR.
    imu:
      topic: /imu
      type: sensor_msgs/Imu

    # Magnetometer (calibrated, SI Tesla).
    # Published by the BNO055/BNO085 on the Pico variant.
    # Not available on stock TurtleBot3 (OpenCR does not expose a /mag topic).
    mag:
      topic: /mag
      type: sensor_msgs/MagneticField

    # Wheel joint positions and velocities from the encoders.
    joint_states:
      topic: /joint_states
      type: sensor_msgs/JointState

    # Uncomment to also subscribe to AMCL / map-frame pose
    # amcl_pose:
    #   topic: /amcl_pose
    #   type: geometry_msgs/PoseWithCovarianceStamped
